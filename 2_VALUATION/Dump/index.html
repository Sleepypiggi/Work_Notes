
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/2_VALUATION/Dump/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Dump - Work Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../config/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prophet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Work Notes" class="md-header__button md-logo" aria-label="Work Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Work Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dump
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Work Notes" class="md-nav__button md-logo" aria-label="Work Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Work Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        Life Insurance
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Products
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Products" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Products
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_PRODUCTS/0_TERM_LIFE/" class="md-nav__link">
        Term Life
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_PRODUCTS/1_WHOLE_LIFE/" class="md-nav__link">
        Whole Life
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_PRODUCTS/2_ENDOWMENT/" class="md-nav__link">
        Endowment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_PRODUCTS/3_PARTICIPATING/" class="md-nav__link">
        Participating
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_PRODUCTS/4_UNIVERSAL_LIFE/" class="md-nav__link">
        Universal Life
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_PRODUCTS/5_INVESTMENT_LINKED.md" class="md-nav__link">
        Investment Linked
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        Valuation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Solvency
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Solvency" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Solvency
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3_SOLVENCY/0_RISK_BASED_CAPITAL/" class="md-nav__link">
        Risk Based Capital
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        Embedded Value
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        IFRS17
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        Distribution
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        Health Insurance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Placeholder.md" class="md-nav__link">
        General Insurance
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-components" class="md-nav__link">
    Key Components
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p>Prophet Array is a loop
Where each iteration of the loop is stored in an array index</p>
<p>Prophet is smart enough to optimise the calculations to know which variable have dependencies needs to be calculated first
They should give you training. Understand structures, structure links and dynamic processing and you will be ahead of the game. The Example Model Office is a great learning tool.</p>
<p>Prophet</p>
<p>Whether a product is run as new business or in force is controlled by </p>
<p>LAST SPCODE FOR EXISTING BUSINESS &gt; Inside run structure</p>
<p>Some codings may change based on this, don’t mix up</p>
<p>Either change MPFILE or SPCODE</p>
<p>Decrement Order &gt;
Lapse is always last because intuitive, you already paid for the current year of coverage. Will stay on till the next payment then skip
FOLLOWS PREMIUM FREQUENCYY</p>
<p>Prophet is about controls and governance that’s why it’s popular
Prophet Parameter vs Read Parameter
Maybe different runs you don’t want that parameter, so can disable if use formula
Prophet is a series of functions that is combined into a product
Before Val date use actual, future use beer</p>
<p>Balance sheet variable not summed, shows as at the latest date</p>
<p>P&amp;L variable summed if extracting over a range of dates (EG Y1)</p>
<p>Public Variable &gt;&gt; What they want to read out</p>
<p>Private variable &gt;&gt; Foe the extended formula only</p>
<p>Prophet can be cleaned up</p>
<p>A lot of common coding can be streamlined into reusable indicators </p>
<p>EG = IF within projection period etc then 1, if RBC2 then 1</p>
<p>Main advantage of prophet is master product, same as</p>
<p>Prophet ! Is used to denote the first row</p>
<p>RI expect an inflow because Recovery got PAD, but premium no PAD</p>
<p>Assuming same underlying risk</p>
<p>Read table of tables need to use read generic table text</p>
<p>Proficiency in Prophet including advanced features like extended formulas, calculation looping, rebasing, modules, ALS is desirable
Prophet different definitions</p>
<h1 id="prophet"><strong>Prophet</strong><a class="headerlink" href="#prophet" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Prophet is a propietary software used to "model" insurance products
 Takes In a set of assumptions, parameters and product features and generates the cashflows for that product
cashflows can be manipulated to calculate other things like EV etc</p>
<p>Why Prophet?
 can be easily done In excel, why need to use this propietary software?
-- Ensure that everyone is using the same set of assumptions/excel; excel may have some error
 Built In product features?</p>
<h2 id="key-components">Key Components<a class="headerlink" href="#key-components" title="Permanent link">&para;</a></h2>
<p>Library
 Collection of commonly used variables
 Conventional Library (for non ULP) &amp; Unit Linked Library (for ULP)
-- Note that a variable is not just a name; it is a name which contains a definition
-- Different types of Variables:
-- Formula (F), transformation of other variables
-- Global (G), value taken from Global table
-- Parameter (P), value taken from Parameter table
-- Model Point (M), value taken from Model Point</p>
<p>Products
-- The "model" which connects the various variables together to generate the cashflows
-- Models built from the conventional library start with "C" while those from the Unit library start with "U"
 There are fundamentally only a few types of products (non Par Insurance, Par Insurance, ILP, non Par Annuity, Par Annuity)
 products sold In the market are simply variations of these products with a subset of the features or based on different assumptions
 Master products are used to Model the common features of these products
 Individual Specific products are Built off these Master products, known as same as products
 They inherit (In a programming sense) the features of these Master products &gt; no need to spend time coding the same features again for each product
 If There are any changes made to these shared features In the Master product, They will automatically flow through the same as products  &gt; no need to spend time to individually change every product
 can control which features that each same as product inherits from the Master product using Flag variables</p>
<p>Tables
 Tables contain the assumptions used In the modelling process
 Global table: assumptions that are fixed In value &amp; apply to all products (Run Number X variable name)
 Parameter table: fixed In value &amp; apply to Individual products (variable name X product)
-- Mainly used to control which product features inherited from the Master Model &amp; other high level assumptions
-- Thus, seperated based on Conventional &amp; Unit Linked
-- Generic Tables: 
 Tables of Tables: Tables</p>
<p>Generic table: Depend on other variables to determine their values</p>
<p>Run Setting
 control metadata about the Run
 Run Specific paramaters: Valuation Date, Type of output etc
-- Table path locations:
---- Multiple paths can be listed for each table; prophet will search the first path for the tables before the second path
-- Hierarchical structure of reading Tables</p>
<p>Run Structure
 States which products to Run and how to group them together
 Some system level definitions are provided here as well, as well as Some metadata</p>
<p>Job (PE Specific) &gt; Putting everything together, select values for the variables here</p>
<p>Summary Library</p>
<p>Level Number &gt; Sequence of calculation
Priorrity system &gt; level 1 is faster</p>
<p>200 &gt; New businessSPCODE
below 200 &gt; IF</p>
<p>Prophet &gt; last sp code for existing business &gt; Means only applies for new business</p>
<p>Keeps everything on memory then outputs</p>
<p>Domain &gt; Everyone
Workspace within domain as many</p>
<p>Workers &gt; Core groups</p>
<p>Upload workspace</p>
<p>Prophet Extration
Proj_Result extracts the numbers from the prophet result file
Sometimes results in error cos product cannot be fond etc
N() to coerce the errors into 0 so that can still sum</p>
<p>Problem is that when extracting a lot of variables at a time, can sometimes crash then get everything erorr or 0
Not sure whether truly 0 or error
Need to slowly recurse</p>
<p>101
102
103
141</p>
<p>Summary Run &gt; Accumulate cashflows into one model point, easier to read</p>
<p>Edits made into Library, compare library to get up to date
Master product contains everything, same as products then control which features to have via flags</p>
<p>SPCODE = Sub Product Code
1 = Jan, 12 = Dec
0 = Whole year</p>
<p>PE Lost contact with worker -- Global/Param Tables have issues
PE if got duplicate, will name _1 in the P drive
Post prod workspace is locked at one machine per run to avoid cannibalising resources from Prod</p>
<p>PROPHET
Tabs at the side or side
MPF will reas relative</p>
<p>Base is where the workspace is open
Run Structure &gt; Product &amp; Accumulation
Run setting &gt; Table locations, table hierarchy
Always validate run settings to check if the path exists</p>
<p>Future Accumulation &gt; Projection length
Past accumulation &gt; Duration if, if u want to see those periods</p>
<p>103 &gt; IF
141 &gt; NB</p>
<p>Unit test &gt; Run the first model point</p>
<p>Two different result foiles
 PROJ File &gt; Call from excel, all years, newbus File, same location as RPT
 RPT &gt; Individual Model Point result File, only Valuation Date
 PROJ tends to be bigger
 Controlled variable group
 If you Call PP variable for PROJ, it will only show first MPT</p>
<p>Can run on multiple machines, but the machines must be able to write to those paths
BPA345</p>
<p>Levels &gt; Priority level
Lower level run first
Product level 10
Summary 11 &gt; Conversion to USD
Accumulation 15/16
Summary 25</p>
<p>Must add new products into accumulation/structure
Prophet Master Model will tell u where to put &gt; Flow chart
Check against the spreadsheet</p>
<p>Table Editor
Dont open in prophet because take prophet license</p>
<p>No more space in text</p>
<p>SPCode is a unique identifier, up to u to define
Within NBEV output, it represents the month that the policy is incepted</p>
<p>Indicator
Different version of the same formula
Can also be used to select indicators</p>
<p>Projection view &gt; Results diagram view &gt; Shows the variable</p>
<p>IF and NB MPF file is different</p>
<p>Differentiate SPCODE in MPF to call out individual results
Run only first model point &gt; Groups by SPCODE
Runs every first SPCODE</p>
<p>If got RI &gt; Defined based RCH Code. Defined by</p>
<p>Table name &gt; Controls all the tables</p>
<p>NB CODING 2</p>
<p>Extended Formula
Custom Formula, not provided by FIS
Think of it like an object
that can output other variables</p>
<p>Can have super model but split for efficiency
Result Diagram View &gt; Need result</p>
<p>Master product &gt; Product Diagram View &gt; Spiderweb
Variable &gt; Click around
FLAG SYSTEM = Control whether the benefit is used</p>
<p>Press validate to check if tables exist</p>
<p>Rong Kang Can approve if
 non year end
 no assumption change
 change In methodology
 Threshold</p>
<p>Model must be ready by 1<sup>st</sup> of the month
1 week review &amp; fix time
Send early
Run whole in force even for early check</p>
<p>Compare Library &gt; OUTPUTS text file &gt; Macro in excel to pick up the changes</p>
<ol>
<li>Run Structure -- tells Prophet which products to run. How come when run single product still need</li>
<li>Flag Mapping -- How do I know what the values mean for each flag? Not everything is 1/0 (Check Variable Properties)</li>
<li>Highlighted words -- Blue is keyword, green is numbers, black is variables, red is prophet defined function/variable (Can search inside the helper function)</li>
</ol>
<p>Variable Groups &gt; Control which variables are output
Model Point File edit &gt; Workspace can edit, full proof like excel</p>
<p>If only want to run 1-2 model point, select all (CTRL A) then exclude all
find the model point u want, include that row only
This can be controlled in the formatting file by excluding * (to confirm)</p>
<p>PROJ function &gt; Reads from result file
rpt file &gt; INDIVIDUAL model point
Should reconcile with each other</p>
<p>Change prophet output format
 Number
 time period, set monthly</p>
<p>If got MPF change, need to ask RBC2 team to regenerate latest month &amp; YE MPF based on the new structure
Becos some source system got no monthly snapshot, they need to patch</p>
<p>Import Variable &gt; Insert or replace
Backup old workspace into PUBZ</p>
<p>Portfolio Impact Checking
 Compares all key variables from previous Model and current Model based on last month end position
-- Rerun BOTH positions (Including last month end; dont just take the production run)
 File will extract results for all variables at product level and compare them
 Check that opening position is correct
 Check the impact to key variables at the fund level
 Check to see If They are expected</p>
<p>Run Setting
Controls everything
Set valuation Date
choose output type &gt; Sup product or just total, can save space
Choose RPT file &amp; variables to output for each (can be different)</p>
<p>if you wanna test, can run with 1<sup>st</sup> MPT for each spcode first
Good to test MPF first then run the full thing</p>
<p>In Force SP Code = 100 - 199
New Business SP Code = 200+
LAST_SPCODE_FOR_EXISTING_BUS = 199</p>
<p>Therefore SP_CODE &gt; LAST_SPCODE -&gt; New business only</p>
<p>Deaths assume to occur middle of month - 
    LAPSE_TMING = 1 means Lapse EOM; die first then remaining ppl lapse
    LAPSE_TMING = 0.5 means Lapse middle OM; compete with deaths</p>
<p>pp run first model point of each SP CODE by defualt, need to change accordingly</p>
<p>Decrement Rate modelling is very important
The base decrement may be ok, but model is always subject to various shocks
Rate should be floored at 0 or capped at 1
Test robustness by shocking an insane amount (EG. 500% or something)</p>
<p>Coding Tips
1. Maintain consistency across products
2. Make your code readable by using "_" to add a new line, similar to VBA
3. Minimize reading tables. If it is a constant, read once at inception (t=0) then all other time periods refer back to that period. If read quarterly or yearly, same concept -&gt; Read only at that time period then refer back. Reason is because reading is an expensive process computationally, thus avoid looking up too much.
4. If a variable varies by time, add (t) behind the variable to denote it. This makes it more readable
5. You can refer to the variable name as a string using VAR_NAME</p>
<p>Prophet table formatting - Consistent number of DPs
Hard to see in excel, open in notepad/propview</p>
<p>Build things to be modular, but if there is no way to test it then dont build it
You cannot ensure that it will be correct, no way to test it.</p>
<p>Time dependent
Reading time-dependent generic tables in Prophet programming language
If a generic table is accessed for each month of the projection it can have a significant impact on performance because of the number of times the table needs to be searched. You should therefore try to limit your use of time-dependent generic tables where possible and you should also try to access them annually rather than monthly.</p>
<p>If you use the READ_GENERIC_TABLE function you should use If Then Else statements to reduce the number of times the generic table is read to the minimum. For example, the following formula might be used for UFII_PC so that the generic table is read annually instead of monthly:</p>
<p>IF t=0 THEN
0
ELSE IF mult(t-1,12) THEN
READ_GENERIC_TABLE("TABNAME","Y","VAR_NAME",CALENDAR_YR)
ELSE</p>
<p>UFII_PC(t-1)</p>
<p>Within Prophet a product is a collection of variables that together represent the desired calculations.</p>
<p>A simple product without Rebasing
Within Prophet a product is a collection of variables that together represent the desired calculations. Each variable can be defined in a number of ways – constants, tables, formulas, extended formulas, etc. The definition of a particular variable can reference another variable.</p>
<p>When a run is carried out, Prophet analyses all the variables in a product. It determines all the appropriate dependencies between the variables and then organises the variables into building blocks. Together these building blocks form a complete representation of the actuarial model defined individually in each of the variables.</p>
<p>Typically a product will contain some variables that have a constant value for all time and others that change with time. Prophet is designed to organise the variables that depend on time into an efficient sequence. Some variables are calculated in an ascending time order, while others are calculated in a descending time order. Some variables will be grouped together so that they are calculated sequentially for each time period.</p>
<p>Prophet seeks to eliminate unnecessary calculations but, if required, the time periods for which the variables will be calculated are the maximum projection term. This is from time equal to 0 to time defined by PROJ_TERM_Y * 12, where PROJ_TERM_Y is a mandatory variable in every product.</p>
<p>A set of simple calculations such as those required for using the discounted cashflow technique can be represented as follows:</p>
<p>A group of variables calculated in an ascending time order. These calculations may represent the projection of cashflows.
A group of variables calculated in a descending time order. These calculations may represent the discounting of the projected cashflows.
The above calculations will produce the discounted cashflow value at a fixed point in time, typically the first time period calculated.</p>
<p>Calculation looping
Calculation looping is a process whereby parts of the calculation are repeated several times. In many ways it is similar to the rebasing facility described in the "Rebasing" chapter of this manual. However, calculation looping differs from rebasing in the following ways:</p>
<p>With calculation looping the parts that are repeated are repeated for the whole of the period of calculation. With rebasing only the projected part of the period of calculation is recalculated in each loop.
With calculation looping there is a mechanism to retain some of the values which are calculated in each loop. With rebasing the values which are recalculated in each loop just overwrite the existing values.
An example of the use of this facility is included in the Conventional, International and Unit Linked libraries. In the Conventional and International libraries, the indicator MIN_RESERVE2 allows the valuation reserves to be calculated on several different interest rates by using a different interest rate in each loop. This is needed for resilience reserve calculations because the mathematical reserves need to be calculated on an interest rate which depends on the yields on the matching assets. To estimate the effect of a change in the interest rate, it is necessary to calculate the valuation reserves on at least two interest rates. In the Unit Linked library, the sterling reserves for regular premium pensions business are calculated in one loop assuming premiums continue to maturity and in a second loop assuming that premiums cease immediately.</p>
<p>NO_CALC function</p>
<p>In order to retain values and ensure that they are not overwritten in a subsequent loop, the function NO_CALC is used with the parameter "C".</p>
<p>Each product has an indicator
Each variable has an indicator logic (EG. Is SG_RBC &amp; NTUC_INCOME)
Each product has variables based on the indicator tag</p>
<p>Problem is: Variable A is under scope
Variable A = Variable B + Variable C
Both B and C must be under the product as well
If not under, the product build will fail at runtime &gt;&gt; Because variable B and/or C are missing
Prophet cannot detect this error</p>
<p>Explanation:
Mini Module within Prophet</p>
<p>Similar to VBA &gt; Declare Variables first then can use them later on
EX Formula is NOT a function &gt; Does not return any particular variable
More like a closure where the variables exist within that scope</p>
<p>KEY NOTE (By default) &gt;&gt;&gt;&gt; Extended formulas are NOT t-dependent &gt;&gt;&gt; NOT calculated at every t
Need to declare t as a private variable within the extended formula and use a loop to repeat the calculation
Usually declared as tt &gt;&gt; Avoid confusion with main t</p>
<p>A t-dependent extended formula is similar to normal extended formula except it is re-run for each month of the projection. This effectively makes it t-dependent and allows you to make references to Prophet variables in your extended formula.</p>
<p>The following example is based on the Lookup function extended formula example used to lookup premium allocation rates. Since this formula is only run once for each model point the allocation rate is wrong for a product with an increasing premium. &gt;&gt; Includes t</p>
<p>PUBLIC &gt; Can be referenced by other variables outside the current EX Formula
PRIVATE &gt; Can only be referenced by the current EX Formula
Not case sensitive</p>
<p>Declare array:
1 NAME(0,0) &gt; Dynamically sized array
2 NAME(2) &gt; Fixed dimension</p>
<p>Need to declare variable type</p>
<p>Syntax:
Variable Assignment uses ":=" lexical token
<variable>[(indices)] := <expression></p>
<p>If expression is too long, can use another line using "_"
Avoid having too long lines so that libary comparison tool doesn't screw up</p>
<p>Statements:
IF THEN ELSEIF ELSE END IF
SWITCH CASE CASE ELSE</p>
<p>Loopong
FOR a to z step 1
Do While, do loop while
For Each &gt; Array only</p>
<p>Reference public variables in an extended formula in the form of
EX_FORMULA_NAME.DECLARED_VARIABLE(Dimension, if any)</p>
<p>PRINT TO FILE
Write text/number output to a file on the disk drive
Open Once &gt;</p>
<p>PE
Domain
Workspace Compartment - affects who can see
Workspace Category - Affects how its displayed
Different User Type (EG. Projects Actuary VS RM USer)
Different User Type can access different compartment (EG. RM User Department)
Different Roles can perform different tasks on the workspace (EG. Job Scheduler)</p>
<p>8 Machines
Each machine 2 workers
Each worker 64 cores
Total = 8 * 2 * 64 = 512 Cores
1 Core can run one MPF</p>
<p>Look into parallel MPF Processing/Concurrent Batches
Modules</p>
<p>PROJ Result &gt; Y1 is calendar y1</p>
<p>Array Variables
X Dimension
Prophet will calculate the whole thing X times
For non-array variables, the value in that slot will be the Xth loop
Since BE is the last loop, variable values will be the BE loop</p>
<p>Extended formula can print results, but very very big
Certain Death Age
Prophet Debug mode
Pricing model &amp; Recon file link</p>
<p>ILP Reserve Calculation
Regulation says from the valuation date onwards, project using RFR</p>
<p>ILP Reserve Calculation
Regulation says from the valuation date onwards, project using RFR</p>
<p>But reserve at time t+n
means t+0 to t+n grow at BEIR
then after t+n, grow at RFR
Complicated logic needs EX Formula</p>
<p>Same for calculating forward rates, need to rebase in each period, so need EX formula</p>
<p>Renewable Term Products
EG Term for 10 years, can renew</p>
<p>More conservative to assume that the PH will not renew
However, if want to model renewability, cannot assume that all will renew - need assume a good chunk of them never renew (Mass Lapse on renewal date)</p>
<p>Lapse Supported Product
Meaning that lapse is good for the policyholder
Term product
Lapse in the early years is bad, cant recoup the cost of the policy
Lapse in the later years is good, collect the money but never pay any benefits</p>
<p>If got surrender benefit, then need see relative size of surrender benefit</p>
<p>Master Product
Expression
Picks up variables according to the expressions</p>
<p>Overriding comm hard to model because it depends on the distribution structure
Agent -&gt; Manager
Maneger -&gt; Head
Agent -&gt; Head</p>
<p>Usually MPF no granulaity</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="../../config/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    
  </body>
</html>